import{S as C,i as L,s as O,e as v,a as S,b as _,c as b,d as $,l as m,n as T,f as y,r as P,g as K,o as ee,h as W,t as z,j as w,k as R,p as te,m as ne,q as se,u as oe,v as k,w as le,x as re,y as ie,z as X,A as Y,B as G,C as N,D as j,E as Q,F}from"./vendor.js";const ae=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const t of i.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&r(t)}).observe(document,{childList:!0,subtree:!0});function o(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=o(s);fetch(s.href,i)}};ae();function ue(l){let e,o,r,s,i;return{c(){e=v("canvas"),o=S(),r=v("input"),_(r,"type","color"),_(r,"aria-label","color"),_(r,"class","absolute")},m(t,n){b(t,e,n),l[7](e),b(t,o,n),b(t,r,n),$(r,l[1].color),s||(i=[m(e,"mousedown",l[2]),m(e,"touchstart",l[2]),m(e,"mouseup",l[3]),m(e,"touchend",l[3]),m(e,"mouseout",l[3]),m(e,"touchcancel",l[3]),m(e,"mousemove",l[8]),m(e,"touchmove",l[9]),m(e,"resize",l[5]),m(r,"input",l[10])],s=!0)},p(t,[n]){n&2&&$(r,t[1].color)},i:T,o:T,d(t){t&&y(e),l[7](null),t&&y(o),t&&y(r),s=!1,P(i)}}}function U(l,e){let o=new Date().getTime();return function(){let r=new Date().getTime();r-o>=e&&(o=r,l.apply(null,arguments))}}function ce(l,e,o){let r=K(),s,i=!1,t,n={color:"#000000"};const g=c=>{let M=s.width,D=s.height;a(c.x0*M,c.y0*D,c.x1*M,c.y1*D,c.color),console.log("event received")};function d(c){i=!0,o(1,n.x=c.clientX||c.touches[0].clientX,n),o(1,n.y=c.clientY||c.touches[0].clientY,n)}function f(c){!i||(i=!1,a(n.x,n.y,c.clientX||c.touches[0].clientX,c.clientY||c.touches[0].clientY,n.color,!0))}function u(c){!i||(a(n.x,n.y,c.clientX||c.touches[0].clientX,c.clientY||c.touches[0].clientY,n.color,!0),o(1,n.x=c.clientX||c.touches[0].clientX,n),o(1,n.y=c.clientY||c.touches[0].clientY,n))}function a(c,M,D,q,A,x){if(t.beginPath(),t.moveTo(c,M),t.lineTo(D,q),t.strokeStyle=A,t.lineWidth=2,t.stroke(),t.closePath(),!x)return;let B=s.width,H=s.height;r("drawing",{x0:c/B,y0:M/H,x1:D/B,y1:q/H,color:A})}function h(){o(0,s.width=window.innerWidth,s),o(0,s.height=window.innerHeight,s)}ee(()=>{t=s.getContext("2d"),window.addEventListener("resize",h,!1),h()});function p(c){W[c?"unshift":"push"](()=>{s=c,o(0,s)})}const E=c=>U(u(c),10),V=c=>U(u(c),10);function Z(){n.color=this.value,o(1,n)}return[s,n,d,f,u,h,g,p,E,V,Z]}class fe extends C{constructor(e){super();L(this,e,ce,ue,O,{onDrawingEvent:6})}get onDrawingEvent(){return this.$$.ctx[6]}}function I(l,e,o){const r=l.slice();return r[2]=e[o],r}function J(l){var n;let e,o=((n=l[2])==null?void 0:n.user)+"",r,s,i=l[2].message+"",t;return{c(){e=v("li"),r=z(o),s=z(": "),t=z(i),_(e,"class","bg-fade rounded p-1 m-2")},m(g,d){b(g,e,d),w(e,r),w(e,s),w(e,t)},p(g,d){var f;d&1&&o!==(o=((f=g[2])==null?void 0:f.user)+"")&&R(r,o),d&1&&i!==(i=g[2].message+"")&&R(t,i)},d(g){g&&y(e)}}}function ge(l){let e,o,r,s,i,t,n,g,d,f=l[0],u=[];for(let a=0;a<f.length;a+=1)u[a]=J(I(l,f,a));return{c(){e=v("div"),o=v("div"),o.innerHTML='<h4 class="pl-4 pr-8 py-2">Chat</h4>',r=S(),s=v("ul");for(let a=0;a<u.length;a+=1)u[a].c();i=S(),t=v("form"),n=v("input"),_(o,"class","bg-primary rounded-t flex justify-between gap-2"),_(s,"class","bg-white p-2 max-h-72 overflow-auto"),_(n,"type","text"),_(n,"placeholder","Type Message"),_(n,"class","rounded border border-fade outline-fade flex-1 px-2 text-primary"),_(n,"aria-label","Message"),_(t,"class","bg-white p-1 flex")},m(a,h){b(a,e,h),w(e,o),w(e,r),w(e,s);for(let p=0;p<u.length;p+=1)u[p].m(s,null);l[5](s),w(e,i),w(e,t),w(t,n),$(n,l[2]),g||(d=[m(n,"input",l[6]),m(t,"submit",te(l[3]))],g=!0)},p(a,[h]){if(h&1){f=a[0];let p;for(p=0;p<f.length;p+=1){const E=I(a,f,p);u[p]?u[p].p(E,h):(u[p]=J(E),u[p].c(),u[p].m(s,null))}for(;p<u.length;p+=1)u[p].d(1);u.length=f.length}h&4&&n.value!==a[2]&&$(n,a[2])},i:T,o:T,d(a){a&&y(e),ne(u,a),l[5](null),g=!1,P(d)}}}function pe(l,e,o){let r=K(),s=[],i="";const t=a=>{s.push(a),o(0,s)},n=()=>{i.length>0&&(s.push({user:"Me",message:i}),r("message",{message:i}),o(2,i=""),o(0,s))},g=async a=>{a.scroll({top:a.scrollHeight,behavior:"smooth"})};let d;se(()=>{d&&g(d)});function f(a){W[a?"unshift":"push"](()=>{d=a,o(1,d)})}function u(){i=this.value,o(2,i)}return l.$$.update=()=>{l.$$.dirty&3&&d&&s&&g(d)},[s,d,i,n,t,f,u]}class de extends C{constructor(e){super();L(this,e,pe,ge,O,{newMessage:4})}get newMessage(){return this.$$.ctx[4]}}function he(l){let e,o,r,s;const i=l[6].default,t=oe(i,l,l[5],null);return{c(){e=v("section"),t&&t.c(),k(e,"left",l[0]+"px"),k(e,"top",l[1]+"px"),_(e,"class","draggable svelte-jzvapm")},m(n,g){b(n,e,g),t&&t.m(e,null),o=!0,r||(s=[m(window,"mouseup",l[4]),m(window,"mousemove",l[3]),m(e,"mousedown",l[2])],r=!0)},p(n,[g]){t&&t.p&&(!o||g&32)&&le(t,i,n,n[5],o?ie(i,n[5],g,null):re(n[5]),null),(!o||g&1)&&k(e,"left",n[0]+"px"),(!o||g&2)&&k(e,"top",n[1]+"px")},i(n){o||(X(t,n),o=!0)},o(n){Y(t,n),o=!1},d(n){n&&y(e),t&&t.d(n),r=!1,P(s)}}}function me(l,e,o){let{$$slots:r={},$$scope:s}=e,{left:i=100}=e,{top:t=100}=e,n=!1;function g(){n=!0}function d(u){n&&(o(0,i+=u.movementX),o(1,t+=u.movementY))}function f(){n=!1}return l.$$set=u=>{"left"in u&&o(0,i=u.left),"top"in u&&o(1,t=u.top),"$$scope"in u&&o(5,s=u.$$scope)},[i,t,g,d,f,s,r]}class _e extends C{constructor(e){super();L(this,e,me,he,O,{left:0,top:1})}}function we(l){let e,o,r;function s(t){l[5](t)}let i={};return l[1]!==void 0&&(i.newMessage=l[1]),e=new de({props:i}),W.push(()=>G(e,"newMessage",s)),e.$on("message",l[6]),{c(){N(e.$$.fragment)},m(t,n){j(e,t,n),r=!0},p(t,n){const g={};!o&&n&2&&(o=!0,g.newMessage=t[1],Q(()=>o=!1)),e.$set(g)},i(t){r||(X(e.$$.fragment,t),r=!0)},o(t){Y(e.$$.fragment,t),r=!1},d(t){F(e,t)}}}function ve(l){let e,o,r,s,i,t,n;function g(f){l[3](f)}let d={};return l[0]!==void 0&&(d.onDrawingEvent=l[0]),r=new fe({props:d}),W.push(()=>G(r,"onDrawingEvent",g)),r.$on("drawing",l[4]),t=new _e({props:{$$slots:{default:[we]},$$scope:{ctx:l}}}),{c(){e=v("main"),o=v("section"),N(r.$$.fragment),i=S(),N(t.$$.fragment),_(o,"class","flex sm:flex-row flex-1 w-full"),_(e,"class","flex flex-col h-screen w-screen bg-fade relative")},m(f,u){b(f,e,u),w(e,o),j(r,o,null),w(o,i),j(t,o,null),n=!0},p(f,[u]){const a={};!s&&u&1&&(s=!0,a.onDrawingEvent=f[0],Q(()=>s=!1)),r.$set(a);const h={};u&514&&(h.$$scope={dirty:u,ctx:f}),t.$set(h)},i(f){n||(X(r.$$.fragment,f),X(t.$$.fragment,f),n=!0)},o(f){Y(r.$$.fragment,f),Y(t.$$.fragment,f),n=!1},d(f){f&&y(e),F(r),F(t)}}}function be(l,e,o){"serviceWorker"in navigator&&navigator.serviceWorker.register("/serviceWorker.js").then(()=>console.log("Service worker registered!")).catch(a=>console.error("Failed to register service worker",a));let r;const s=(a,h)=>r.send(JSON.stringify({event:a,data:h}));let i,t;const n=()=>{r=new WebSocket((location.protocol==="https:"?"wss://":"ws://")+location.host),r.onopen=a=>{console.log("Successfully Connected To Server Socket"),r.onmessage=h=>{const p=JSON.parse(h.data);p.event&&p.event==="drawing"&&i(p.data),p.event&&p.event==="message"&&t(p.data)},r.onclose=()=>{console.log("Retrying Connection"),n()}},r.onerror=a=>{console.error("Failed to connect. Retrying in 3 seconds",a),setTimeout(n,3e3)}};n();function g(a){i=a,o(0,i)}const d=a=>s("drawing",a.detail);function f(a){t=a,o(1,t)}return[i,t,s,g,d,f,a=>s("message",a.detail)]}class ye extends C{constructor(e){super();L(this,e,be,ve,O,{})}}new ye({target:document.getElementById("app")});
